<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pup Cid's Little TikTok Helper</title>
    <link rel="stylesheet" href="/css/tailwind.output.css">
    <link rel="stylesheet" href="/css/navigation.css">
    <script src="/js/lucide.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body class="bg-gray-900 text-white">

    <!-- Main Layout Container -->
    <div class="flex h-screen">

        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="sidebar sidebar-expanded">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i data-lucide="zap" class="sidebar-logo-icon"></i>
                    <span class="sidebar-logo-text">Pup Cid's Helper</span>
                </div>
                <button id="sidebar-toggle" class="sidebar-toggle-btn">
                    <i data-lucide="panel-left"></i>
                </button>
            </div>

            <nav class="sidebar-nav">
                <!-- Dashboard -->
                <a href="#" class="sidebar-item active" data-view="dashboard">
                    <i data-lucide="layout-dashboard"></i>
                    <span class="sidebar-item-text">Dashboard</span>
                </a>

                <!-- Category: Automations -->
                <div class="sidebar-category">
                    <span class="sidebar-category-label">Automations</span>
                </div>
                <a href="#" class="sidebar-item" data-view="events">
                    <i data-lucide="activity"></i>
                    <span class="sidebar-item-text">Events</span>
                </a>
                <a href="#" class="sidebar-item" data-view="flows">
                    <i data-lucide="git-branch"></i>
                    <span class="sidebar-item-text">Flows</span>
                </a>
                <a href="#" class="sidebar-item" data-view="goals">
                    <i data-lucide="target"></i>
                    <span class="sidebar-item-text">Goals</span>
                </a>

                <!-- Category: Interaktive Effekte -->
                <div class="sidebar-category">
                    <span class="sidebar-category-label">Interaktive Effekte</span>
                </div>
                <a href="#" class="sidebar-item" data-view="tts">
                    <i data-lucide="mic"></i>
                    <span class="sidebar-item-text">TTS</span>
                </a>
                <a href="#" class="sidebar-item" data-view="soundboard">
                    <i data-lucide="music"></i>
                    <span class="sidebar-item-text">Soundboard</span>
                </a>
                <a href="#" class="sidebar-item" data-view="emoji-rain">
                    <i data-lucide="cloud-rain"></i>
                    <span class="sidebar-item-text">Emoji Rain</span>
                </a>

                <!-- Category: Plugins & Tools -->
                <div class="sidebar-category">
                    <span class="sidebar-category-label">Plugins & Tools</span>
                </div>
                <a href="#" class="sidebar-item" data-view="multi-guest" data-plugin="vdoninja">
                    <i data-lucide="users"></i>
                    <span class="sidebar-item-text">Multi-Guest</span>
                </a>
                <a href="#" class="sidebar-item" data-view="gift-milestone" data-plugin="gift-milestone">
                    <i data-lucide="gift"></i>
                    <span class="sidebar-item-text">Gift Milestone</span>
                </a>
                <a href="#" class="sidebar-item" data-view="multicam" data-plugin="multicam">
                    <i data-lucide="video"></i>
                    <span class="sidebar-item-text">Multi-Cam</span>
                </a>
                <a href="#" class="sidebar-item" data-view="osc-bridge" data-plugin="osc-bridge">
                    <i data-lucide="gamepad-2"></i>
                    <span class="sidebar-item-text">OSC-Bridge</span>
                </a>
                <a href="#" class="sidebar-item" data-view="hybridshock" data-plugin="hybridshock">
                    <i data-lucide="zap"></i>
                    <span class="sidebar-item-text">HybridShock</span>
                </a>
                <a href="#" class="sidebar-item" data-view="openshock" data-plugin="openshock">
                    <i data-lucide="zap"></i>
                    <span class="sidebar-item-text">OpenShock</span>
                </a>
                <a href="#" class="sidebar-item" data-view="quiz-show" data-plugin="quiz-show">
                    <i data-lucide="help-circle"></i>
                    <span class="sidebar-item-text">Quiz Show</span>
                </a>
                <a href="#" class="sidebar-item" data-view="resource-monitor" data-plugin="resource-monitor">
                    <i data-lucide="cpu"></i>
                    <span class="sidebar-item-text">Resources</span>
                </a>
                <a href="#" class="sidebar-item" data-view="plugins">
                    <i data-lucide="plug"></i>
                    <span class="sidebar-item-text">Plugin Manager</span>
                </a>

                <!-- Settings (Fixed at bottom) -->
                <div class="sidebar-spacer"></div>
                <a href="#" class="sidebar-item" data-view="settings">
                    <i data-lucide="settings"></i>
                    <span class="sidebar-item-text">Settings</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Topbar (Reduced) -->
            <header class="topbar">
                <div class="topbar-left">
                    <h1 class="topbar-title">Pup Cid's Little TikTok Helper</h1>
                </div>
                <div class="topbar-right">
                    <div class="topbar-status">
                        <span id="connection-status" class="status-badge status-disconnected">
                            <i data-lucide="circle"></i>
                            <span>Disconnected</span>
                        </span>
                    </div>
                    <button id="profile-btn" class="topbar-profile-btn">
                        <i data-lucide="user"></i>
                        <span id="current-profile-name">default</span>
                    </button>
                    <button id="topbar-settings-btn" class="topbar-icon-btn" title="Global Settings">
                        <i data-lucide="settings"></i>
                    </button>
                </div>
            </header>

            <!-- Content Views Container -->
            <div class="content-container">

                <!-- View: Dashboard -->
                <div id="view-dashboard" class="content-view active">

                    <!-- 1. TikTok Live Connection Section -->
                    <section class="dashboard-section connection-section">
                        <h2 class="section-title">
                            <i data-lucide="wifi"></i>
                            TikTok Live Connection
                        </h2>
                        <div class="connection-controls">
                            <input type="text" id="username-input" placeholder="TikTok Username (ohne @)"
                                   class="connection-input">
                            <button id="connect-btn" class="btn btn-primary">
                                <i data-lucide="link"></i>
                                Connect
                            </button>
                            <button id="disconnect-btn" class="btn btn-danger" disabled>
                                <i data-lucide="link-2-off"></i>
                                Disconnect
                            </button>
                        </div>
                        <div id="connection-info" class="connection-info"></div>
                    </section>

                    <!-- 2. Quick Actions Section (Compact Button Grid) -->
                    <section class="dashboard-section actions-section">
                        <h2 class="section-title">
                            <i data-lucide="zap"></i>
                            Quick Actions
                        </h2>
                        <div class="quick-actions-button-grid">
                            <button class="quick-action-btn" id="quick-tts-btn" data-action="tts" data-state="on">
                                <i data-lucide="mic"></i>
                                <span>Text-to-Speech</span>
                            </button>
                            <button class="quick-action-btn" id="quick-soundboard-btn" data-action="soundboard" data-state="on">
                                <i data-lucide="music"></i>
                                <span>Soundboard</span>
                            </button>
                            <button class="quick-action-btn" id="quick-flows-btn" data-action="flows" data-state="on">
                                <i data-lucide="git-branch"></i>
                                <span>Automation Flows</span>
                            </button>
                            <button class="quick-action-btn" id="quick-emoji-rain-btn" data-action="emoji-rain" data-state="on">
                                <i data-lucide="cloud-rain"></i>
                                <span>Emoji Rain</span>
                            </button>
                            <button class="quick-action-btn" id="quick-osc-bridge-btn" data-action="osc-bridge" data-state="off" data-plugin="osc-bridge">
                                <i data-lucide="gamepad-2"></i>
                                <span>OSC-Bridge</span>
                            </button>
                        </div>
                    </section>

                    <!-- 3. Live Statistics Section (with Runtime) -->
                    <section class="dashboard-section stats-section">
                        <h2 class="section-title">
                            <i data-lucide="trending-up"></i>
                            Live Statistics
                        </h2>
                        <div class="stats-grid">
                            <div class="stat-card stat-card-runtime">
                                <div class="stat-icon">
                                    <i data-lucide="clock"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Stream Runtime</div>
                                    <div class="stat-value" id="stat-runtime">--:--:--</div>
                                </div>
                                <canvas id="runtime-sparkline" class="stat-sparkline" width="150" height="40"></canvas>
                            </div>
                            <div class="stat-card stat-card-viewers">
                                <div class="stat-icon">
                                    <i data-lucide="users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Viewers</div>
                                    <div class="stat-value" id="stat-viewers">0</div>
                                </div>
                            </div>
                            <div class="stat-card stat-card-likes">
                                <div class="stat-icon">
                                    <i data-lucide="heart"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Likes</div>
                                    <div class="stat-value" id="stat-likes">0</div>
                                </div>
                            </div>
                            <div class="stat-card stat-card-coins">
                                <div class="stat-icon">
                                    <i data-lucide="coins"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Coins</div>
                                    <div class="stat-value" id="stat-coins">0</div>
                                </div>
                            </div>
                            <div class="stat-card stat-card-followers">
                                <div class="stat-icon">
                                    <i data-lucide="star"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Followers</div>
                                    <div class="stat-value" id="stat-followers">0</div>
                                </div>
                            </div>
                            <div class="stat-card stat-card-gifts">
                                <div class="stat-icon">
                                    <i data-lucide="gift"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Gifts</div>
                                    <div class="stat-value" id="stat-gifts">0</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 4. Updates / Features / Changelog Section (NEW) -->
                    <section class="dashboard-section updates-section" id="updates-section">
                        <div class="updates-header">
                            <h2 class="section-title">
                                <i data-lucide="sparkles"></i>
                                Updates & Features
                            </h2>
                            <button id="dismiss-updates-btn" class="btn btn-sm btn-ghost">
                                <i data-lucide="x"></i>
                                Ausblenden
                            </button>
                        </div>
                        <div class="updates-content" id="updates-content">
                            <div class="loading-indicator">
                                <i data-lucide="loader"></i>
                                <span>Loading changelog...</span>
                            </div>
                        </div>
                        <button id="show-more-changelog-btn" class="btn btn-sm btn-ghost" style="margin-top: 1rem; display: none;">
                            <i data-lucide="chevron-down"></i>
                            Mehr anzeigen
                        </button>
                    </section>

                    <!-- 5. Plugin & Tool Shortcuts -->
                    <section class="dashboard-section shortcuts-section">
                        <h2 class="section-title">
                            <i data-lucide="grid-3x3"></i>
                            Tools & Plugins
                        </h2>
                        <div class="shortcuts-grid" id="shortcuts-grid">
                            <!-- Will be dynamically populated -->
                        </div>
                    </section>

                    <!-- 6. FAQ / Help Center Section (NEW) -->
                    <section class="dashboard-section faq-section">
                        <h2 class="section-title">
                            <i data-lucide="help-circle"></i>
                            FAQ & Help Center
                        </h2>
                        <div class="faq-accordion" id="faq-accordion">
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Wie verbinde ich mich mit einem TikTok LIVE Stream?</span>
                                </button>
                                <div class="faq-content">
                                    <p>Geben Sie einfach den TikTok-Benutzernamen (ohne @-Zeichen) in das Eingabefeld ein und klicken Sie auf "Connect". Stellen Sie sicher, dass der Benutzer gerade LIVE ist.</p>
                                    <p><strong>Tipp:</strong> Der Benutzer muss während der Verbindung live streamen.</p>
                                </div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Wie aktiviere ich Text-to-Speech (TTS)?</span>
                                </button>
                                <div class="faq-content">
                                    <p>TTS ist standardmäßig aktiviert. Sie können es über den grünen "Text-to-Speech" Button in den Quick Actions steuern.</p>
                                    <p>Für erweiterte Einstellungen gehen Sie zu TTS in der Seitenleiste oder den Settings.</p>
                                </div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Was sind Automation Flows?</span>
                                </button>
                                <div class="faq-content">
                                    <p>Automation Flows ermöglichen es Ihnen, automatische Aktionen basierend auf TikTok-Events zu erstellen.</p>
                                    <p>Beispiel: Spielen Sie einen Sound ab, wenn jemand ein bestimmtes Gift sendet, oder zeigen Sie eine Alert an, wenn Sie einen neuen Follower bekommen.</p>
                                    <p><strong>Zugriff:</strong> Klicken Sie auf "Flows" in der Seitenleiste.</p>
                                </div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Wie füge ich das Overlay zu OBS hinzu?</span>
                                </button>
                                <div class="faq-content">
                                    <p>1. Öffnen Sie OBS Studio</p>
                                    <p>2. Fügen Sie eine neue "Browser"-Quelle hinzu</p>
                                    <p>3. URL: <code>http://localhost:3000/overlay</code></p>
                                    <p>4. Breite: 1920, Höhe: 1080</p>
                                    <p>5. Aktivieren Sie "Shutdown source when not visible"</p>
                                </div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Wo finde ich die System Resources?</span>
                                </button>
                                <div class="faq-content">
                                    <p>Die System-Ressourcen (CPU, RAM, etc.) werden kompakt am Ende des Dashboards angezeigt.</p>
                                    <p>Für detaillierte Informationen klicken Sie auf "Resources" in der Seitenleiste oder in den Tools & Plugins.</p>
                                </div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-toggle">
                                    <i data-lucide="chevron-right"></i>
                                    <span>Wie installiere ich neue Plugins?</span>
                                </button>
                                <div class="faq-content">
                                    <p>1. Gehen Sie zum "Plugin Manager" in der Seitenleiste</p>
                                    <p>2. Klicken Sie auf "Upload Plugin (ZIP)"</p>
                                    <p>3. Wählen Sie die Plugin-ZIP-Datei aus</p>
                                    <p>4. Das Plugin wird automatisch installiert und aktiviert</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 7. System Resources Section (Compact, at bottom) -->
                    <section class="dashboard-section resource-section-compact">
                        <h2 class="section-title-compact">
                            <i data-lucide="activity"></i>
                            <span>System Resources</span>
                            <a href="#" class="resource-details-link" data-view="resource-monitor" data-plugin="resource-monitor">
                                Details <i data-lucide="arrow-right"></i>
                            </a>
                        </h2>
                        <div class="resource-grid-compact">
                            <div class="resource-card-compact">
                                <div class="resource-info">
                                    <i data-lucide="cpu"></i>
                                    <span class="resource-label">CPU</span>
                                    <span class="resource-value-compact" id="resource-cpu-compact">0%</span>
                                </div>
                                <div class="resource-bar-compact">
                                    <div class="resource-bar-fill-compact" id="resource-cpu-bar-compact" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="resource-card-compact">
                                <div class="resource-info">
                                    <i data-lucide="memory-stick"></i>
                                    <span class="resource-label">RAM</span>
                                    <span class="resource-value-compact" id="resource-ram-compact">0%</span>
                                </div>
                                <div class="resource-bar-compact">
                                    <div class="resource-bar-fill-compact" id="resource-ram-bar-compact" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="resource-card-compact">
                                <div class="resource-info">
                                    <i data-lucide="hard-drive"></i>
                                    <span class="resource-label">GPU</span>
                                    <span class="resource-value-compact" id="resource-gpu-compact">--</span>
                                </div>
                                <canvas id="gpu-sparkline" class="resource-sparkline-compact" width="100" height="20"></canvas>
                            </div>
                            <div class="resource-card-compact">
                                <div class="resource-info">
                                    <i data-lucide="wifi"></i>
                                    <span class="resource-label">Network</span>
                                    <span class="resource-value-compact" id="resource-network-compact">0 KB/s</span>
                                </div>
                                <canvas id="network-sparkline" class="resource-sparkline-compact" width="100" height="20"></canvas>
                            </div>
                        </div>
                    </section>

                </div>

                <!-- View: Events -->
                <div id="view-events" class="content-view">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="activity"></i>
                                Live Event Log
                            </h2>
                            <button id="clear-events-btn" class="btn btn-sm btn-ghost">
                                <i data-lucide="trash-2"></i>
                                Clear
                            </button>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Type</th>
                                        <th>User</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="event-log"></tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- View: Flows -->
                <div id="view-flows" class="content-view">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="git-branch"></i>
                                Automation Flows
                            </h2>
                            <button id="add-flow-btn" class="btn btn-primary">
                                <i data-lucide="plus"></i>
                                Create Flow
                            </button>
                        </div>
                        <div id="flows-list" class="flows-container"></div>
                    </section>
                </div>

                <!-- View: Goals -->
                <div id="view-goals" class="content-view" data-plugin="goals">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="target"></i>
                                Live Goals
                            </h2>
                            <a href="/goals/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/goals/ui" title="Live Goals Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: TTS -->
                <div id="view-tts" class="content-view" data-plugin="tts">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="mic"></i>
                                TTS v2.0 - Text-to-Speech System
                            </h2>
                            <a href="/plugins/tts/ui/admin-panel.html" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/plugins/tts/ui/admin-panel.html" title="TTS Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Soundboard -->
                <div id="view-soundboard" class="content-view" data-plugin="soundboard">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="music"></i>
                                Soundboard Configuration
                            </h2>
                        </div>
                        <div class="soundboard-content">
                            <!-- Playback Settings -->
                            <div class="settings-card">
                                <h3 class="card-title">
                                    <i data-lucide="settings"></i>
                                    Playback Settings
                                </h3>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Play Mode</label>
                                        <select id="soundboard-play-mode" class="form-select">
                                            <option value="overlap">Overlap (play immediately)</option>
                                            <option value="sequential">Sequential (queue)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Max Queue Length</label>
                                        <input type="number" id="soundboard-max-queue" min="1" max="50" value="10" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="soundboard-enabled" checked>
                                            <span>Enable Soundboard</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Event Sounds -->
                            <div class="settings-card">
                                <h3 class="card-title">
                                    <i data-lucide="volume-2"></i>
                                    Event Sounds
                                </h3>
                                <div class="event-sounds-grid">
                                    <div class="event-sound-item">
                                        <div class="event-sound-header">
                                            <i data-lucide="star"></i>
                                            <span>Follow Sound</span>
                                            <button onclick="testEventSound('follow')" class="btn btn-xs btn-ghost">
                                                <i data-lucide="play"></i>
                                            </button>
                                        </div>
                                        <input type="text" id="soundboard-follow-url" placeholder="Sound URL" class="form-input">
                                        <input type="number" id="soundboard-follow-volume" min="0" max="1" step="0.1" value="1.0" placeholder="Volume" class="form-input">
                                    </div>

                                    <div class="event-sound-item">
                                        <div class="event-sound-header">
                                            <i data-lucide="users"></i>
                                            <span>Subscribe Sound</span>
                                            <button onclick="testEventSound('subscribe')" class="btn btn-xs btn-ghost">
                                                <i data-lucide="play"></i>
                                            </button>
                                        </div>
                                        <input type="text" id="soundboard-subscribe-url" placeholder="Sound URL" class="form-input">
                                        <input type="number" id="soundboard-subscribe-volume" min="0" max="1" step="0.1" value="1.0" class="form-input">
                                    </div>

                                    <div class="event-sound-item">
                                        <div class="event-sound-header">
                                            <i data-lucide="share-2"></i>
                                            <span>Share Sound</span>
                                            <button onclick="testEventSound('share')" class="btn btn-xs btn-ghost">
                                                <i data-lucide="play"></i>
                                            </button>
                                        </div>
                                        <input type="text" id="soundboard-share-url" placeholder="Sound URL" class="form-input">
                                        <input type="number" id="soundboard-share-volume" min="0" max="1" step="0.1" value="1.0" class="form-input">
                                    </div>

                                    <div class="event-sound-item">
                                        <div class="event-sound-header">
                                            <i data-lucide="gift"></i>
                                            <span>Default Gift Sound</span>
                                            <button onclick="testEventSound('gift')" class="btn btn-xs btn-ghost">
                                                <i data-lucide="play"></i>
                                            </button>
                                        </div>
                                        <input type="text" id="soundboard-gift-url" placeholder="Sound URL" class="form-input">
                                        <input type="number" id="soundboard-gift-volume" min="0" max="1" step="0.1" value="1.0" class="form-input">
                                    </div>

                                    <div class="event-sound-item">
                                        <div class="event-sound-header">
                                            <i data-lucide="heart"></i>
                                            <span>Like Threshold Sound</span>
                                            <button onclick="testEventSound('like')" class="btn btn-xs btn-ghost">
                                                <i data-lucide="play"></i>
                                            </button>
                                        </div>
                                        <input type="text" id="soundboard-like-url" placeholder="Sound URL" class="form-input">
                                        <input type="number" id="soundboard-like-volume" min="0" max="1" step="0.1" value="1.0" class="form-input">
                                        <div class="form-grid">
                                            <input type="number" id="soundboard-like-threshold" min="0" value="0" placeholder="Threshold" class="form-input">
                                            <input type="number" id="soundboard-like-window" min="1" value="10" placeholder="Window (s)" class="form-input">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Gift-Specific Sounds -->
                            <div class="settings-card">
                                <h3 class="card-title">
                                    <i data-lucide="gift"></i>
                                    Gift-Specific Sounds
                                </h3>

                                <!-- Gift Catalog Browser -->
                                <div class="gift-catalog">
                                    <div class="gift-catalog-header">
                                        <h4>Available Gifts from Stream</h4>
                                        <button onclick="refreshGiftCatalog()" id="refresh-catalog-btn" class="btn btn-sm btn-primary">
                                            <i data-lucide="refresh-cw" id="refresh-icon"></i>
                                            Refresh Catalog
                                        </button>
                                    </div>
                                    <div id="gift-catalog-info" class="gift-catalog-info"></div>
                                    <div id="gift-catalog-list" class="gift-catalog-grid"></div>
                                </div>

                                <!-- MyInstants Search -->
                                <div class="myinstants-search">
                                    <h4>Search MyInstants</h4>
                                    <div class="search-box">
                                        <input type="text" id="myinstants-search-input" placeholder="Search sounds..." class="form-input">
                                        <button onclick="searchMyInstants()" class="btn btn-primary">
                                            <i data-lucide="search"></i>
                                            Search
                                        </button>
                                    </div>
                                    <div id="myinstants-results" class="myinstants-results"></div>
                                </div>

                                <!-- Add Gift Sound -->
                                <div class="add-gift-sound">
                                    <h4>Add/Edit Gift Sound</h4>
                                    <div class="form-grid">
                                        <input type="number" id="new-gift-id" placeholder="Gift ID" readonly class="form-input">
                                        <input type="text" id="new-gift-label" placeholder="Label" readonly class="form-input">
                                        <input type="text" id="new-gift-url" placeholder="MP3 URL" class="form-input">
                                        <input type="number" id="new-gift-volume" min="0" max="1" step="0.1" value="1.0" placeholder="Volume" class="form-input">
                                    </div>
                                    <div class="form-grid">
                                        <input type="text" id="new-gift-animation-url" placeholder="Animation URL (optional)" class="form-input">
                                        <select id="new-gift-animation-type" class="form-select">
                                            <option value="none">No Animation</option>
                                            <option value="image">Image</option>
                                            <option value="video">Video</option>
                                            <option value="gif">GIF</option>
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button onclick="addGiftSound()" class="btn btn-primary">
                                            <i data-lucide="plus"></i>
                                            Add/Update Gift Sound
                                        </button>
                                        <button onclick="clearGiftSoundForm()" class="btn btn-ghost">Clear</button>
                                    </div>
                                </div>

                                <!-- Gift Sounds List -->
                                <div class="table-container">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Gift ID</th>
                                                <th>Label</th>
                                                <th>Sound</th>
                                                <th>Volume</th>
                                                <th>Animation</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="gift-sounds-list"></tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button onclick="saveSoundboardSettings()" class="btn btn-primary btn-lg">
                                    <i data-lucide="save"></i>
                                    Save Soundboard Settings
                                </button>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- View: Emoji Rain -->
                <div id="view-emoji-rain" class="content-view" data-plugin="emoji-rain">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="cloud-rain"></i>
                                Emoji Rain v2.0
                            </h2>
                            <a href="/emoji-rain/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/emoji-rain/ui" title="Emoji Rain Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Multi-Guest -->
                <div id="view-multi-guest" class="content-view" data-plugin="vdoninja">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="users"></i>
                                VDO.Ninja Multi-Guest
                            </h2>
                        </div>
                        <!-- Content from original multiGuest tab -->
                        <div class="vdo-content">
                            <p class="text-gray-400">VDO.Ninja Multi-Guest controls will be integrated here...</p>
                        </div>
                    </section>
                </div>

                <!-- View: Gift Milestone -->
                <div id="view-gift-milestone" class="content-view" data-plugin="gift-milestone">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="gift"></i>
                                Gift Milestone Celebration
                            </h2>
                            <a href="/gift-milestone/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/gift-milestone/ui" title="Gift Milestone Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Multi-Cam -->
                <div id="view-multicam" class="content-view" data-plugin="multicam">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="video"></i>
                                Multi-Cam Switcher
                            </h2>
                            <a href="/plugins/multicam/ui.html" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/plugins/multicam/ui.html" title="Multi-Cam Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: OSC-Bridge -->
                <div id="view-osc-bridge" class="content-view" data-plugin="osc-bridge">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="gamepad-2"></i>
                                OSC-Bridge (VRChat)
                            </h2>
                            <a href="/plugins/osc-bridge/ui.html" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/plugins/osc-bridge/ui.html" title="OSC-Bridge Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: HybridShock -->
                <div id="view-hybridshock" class="content-view" data-plugin="hybridshock">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="zap"></i>
                                HybridShock Integration
                            </h2>
                            <a href="/hybridshock/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/hybridshock/ui" title="HybridShock Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: OpenShock -->
                <div id="view-openshock" class="content-view" data-plugin="openshock">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="zap"></i>
                                OpenShock Integration
                            </h2>
                            <a href="/openshock/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/openshock/ui" title="OpenShock Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Quiz Show -->
                <div id="view-quiz-show" class="content-view" data-plugin="quiz-show">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="help-circle"></i>
                                Quiz Show
                            </h2>
                            <a href="/quiz-show/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/quiz-show/ui" title="Quiz Show Configuration"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Resource Monitor -->
                <div id="view-resource-monitor" class="content-view" data-plugin="resource-monitor">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="cpu"></i>
                                System Resource Monitor
                            </h2>
                            <a href="/resource-monitor/ui" target="_blank" class="btn btn-sm btn-ghost">
                                <i data-lucide="external-link"></i>
                                Open in New Tab
                            </a>
                        </div>
                        <div class="iframe-container">
                            <iframe src="/resource-monitor/ui" title="Resource Monitor"></iframe>
                        </div>
                    </section>
                </div>

                <!-- View: Plugins -->
                <div id="view-plugins" class="content-view">
                    <section class="view-section">
                        <div class="view-header">
                            <h2 class="view-title">
                                <i data-lucide="plug"></i>
                                Plugin Manager
                            </h2>
                            <div class="view-actions">
                                <button id="reload-plugins-btn" class="btn btn-sm btn-ghost">
                                    <i data-lucide="refresh-cw"></i>
                                    Reload All
                                </button>
                                <button id="upload-plugin-btn" class="btn btn-sm btn-primary">
                                    <i data-lucide="upload"></i>
                                    Upload Plugin (ZIP)
                                </button>
                            </div>
                        </div>
                        <input type="file" id="plugin-file-input" accept=".zip" style="display: none">
                        <div class="info-banner">
                            <i data-lucide="info"></i>
                            <p>Plugins erweitern die Funktionalität des Tools. Du kannst ZIP-Dateien hochladen, die ein plugin.json und eine main.js enthalten.</p>
                        </div>
                        <div id="plugins-container" class="plugins-grid"></div>
                    </section>
                </div>

                <!-- View: Settings -->
                <div id="view-settings" class="content-view">
                    <section class="view-section">
                        <h2 class="view-title">
                            <i data-lucide="settings"></i>
                            Global Settings
                        </h2>

                        <!-- Audio Engine Settings -->
                        <div class="settings-card">
                            <h3 class="card-title">
                                <i data-lucide="volume-2"></i>
                                Audio Engine Settings
                            </h3>
                            <div class="form-group">
                                <label for="master-volume">Master Volume: <span id="master-volume-label">100</span>%</label>
                                <input type="range" min="0" max="100" value="100" id="master-volume" class="form-range">
                            </div>
                            <div class="form-group">
                                <label for="audio-output-device">Audio Output Device</label>
                                <select id="audio-output-device" class="form-select">
                                    <option value="default">Standard-Ausgabegerät</option>
                                </select>
                                <p class="form-help">⚠️ Die Auswahl des Audio-Geräts funktioniert nur in Chromium-basierten Browsern und OBS.</p>
                            </div>
                        </div>

                        <!-- Auto-Start Settings -->
                        <div class="settings-card">
                            <h3 class="card-title">
                                <i data-lucide="power"></i>
                                Auto-Start Settings
                            </h3>
                            <div class="settings-info-grid">
                                <div class="info-item">
                                    <span class="info-label">Platform:</span>
                                    <span id="autostart-platform-name" class="info-value">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Supported:</span>
                                    <span id="autostart-supported" class="info-value">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Status:</span>
                                    <span id="autostart-status" class="info-value">Checking...</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="autostart-enabled">
                                    <span>Enable Auto-Start on System Boot</span>
                                </label>
                            </div>
                        </div>

                        <!-- Import/Export Presets -->
                        <div class="settings-card">
                            <h3 class="card-title">
                                <i data-lucide="package"></i>
                                Import/Export Configuration Presets
                            </h3>

                            <!-- Export Section -->
                            <div class="preset-section">
                                <h4>Export Configuration</h4>
                                <div class="checkbox-grid">
                                    <label class="checkbox-label"><input type="checkbox" id="export-settings" checked> Settings</label>
                                    <label class="checkbox-label"><input type="checkbox" id="export-flows" checked> Flows</label>
                                    <label class="checkbox-label"><input type="checkbox" id="export-alerts" checked> Alerts</label>
                                    <label class="checkbox-label"><input type="checkbox" id="export-gift-sounds" checked> Gift Sounds</label>
                                    <label class="checkbox-label"><input type="checkbox" id="export-voice-mappings" checked> Voice Mappings</label>
                                    <label class="checkbox-label"><input type="checkbox" id="export-plugin-configs" checked> Plugin Configs</label>
                                </div>
                                <div class="form-group">
                                    <label for="preset-name">Preset Name:</label>
                                    <input type="text" id="preset-name" placeholder="My Awesome Config" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="preset-description">Description (optional):</label>
                                    <textarea id="preset-description" placeholder="Describe your configuration..." rows="2" class="form-textarea"></textarea>
                                </div>
                                <button id="export-preset-btn" class="btn btn-primary">
                                    <i data-lucide="download"></i>
                                    Export Configuration
                                </button>
                            </div>

                            <!-- Import Section -->
                            <div class="preset-section">
                                <h4>Import Configuration</h4>
                                <div class="checkbox-grid">
                                    <label class="checkbox-label"><input type="checkbox" id="import-overwrite"> Overwrite existing</label>
                                    <label class="checkbox-label"><input type="checkbox" id="import-backup" checked> Create backup first</label>
                                </div>
                                <div class="form-group">
                                    <label for="preset-file-input">Select Preset File:</label>
                                    <input type="file" id="preset-file-input" accept=".json" class="form-file">
                                </div>
                                <button id="import-preset-btn" class="btn btn-primary">
                                    <i data-lucide="upload"></i>
                                    Import Configuration
                                </button>
                                <div class="alert alert-warning">
                                    <i data-lucide="alert-triangle"></i>
                                    <span>Importing may overwrite your current settings. A backup will be created if enabled.</span>
                                </div>
                            </div>
                        </div>

                        <!-- Resource Monitor Settings -->
                        <div class="settings-card">
                            <h3 class="card-title">
                                <i data-lucide="cpu"></i>
                                Resource Monitor Settings
                            </h3>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="resource-monitor-enabled">
                                    <span>Enable Resource Monitor</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="resource-monitor-interval">Update Interval: <span id="resource-monitor-interval-label">1.0s</span></label>
                                <input type="range" id="resource-monitor-interval" min="500" max="5000" step="100" value="1000" class="form-range">
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="cpu-warning-yellow">CPU Yellow Warning (%)</label>
                                    <input type="number" id="cpu-warning-yellow" value="5" min="1" max="100" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="cpu-warning-red">CPU Red Warning (%)</label>
                                    <input type="number" id="cpu-warning-red" value="8" min="1" max="100" class="form-input">
                                </div>
                            </div>
                            <button id="save-resource-monitor-settings" class="btn btn-primary">
                                <i data-lucide="save"></i>
                                Save Resource Monitor Settings
                            </button>
                        </div>

                        <!-- OSC-Bridge Settings -->
                        <div class="settings-card" data-plugin="osc-bridge">
                            <h3 class="card-title">
                                <i data-lucide="gamepad-2"></i>
                                OSC-Bridge Settings
                            </h3>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="osc-bridge-enabled">
                                    <span>Enable OSC-Bridge</span>
                                </label>
                                <p class="form-help">Aktiviert die OSC-Bridge für VRChat-Integration. Wenn aktiviert, startet die Bridge automatisch beim Verbindungsaufbau.</p>
                            </div>
                            <div class="info-banner">
                                <i data-lucide="info"></i>
                                <p>Die vollständigen OSC-Bridge Einstellungen (Ports, Verbose-Modus, etc.) finden Sie im OSC-Bridge Tab in der Seitenleiste.</p>
                            </div>
                        </div>

                    </section>
                </div>

            </div>
        </main>
    </div>

    <!-- Modal: User Profiles -->
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i data-lucide="user"></i>
                    User Profile Management
                </h3>
                <button id="profile-modal-close" class="modal-close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="active-profile-banner">
                    <div class="banner-label">Aktives Profil:</div>
                    <div class="banner-value" id="active-profile-display">default</div>
                    <div class="banner-hint">⚠️ Ein Profilwechsel erfordert einen Neustart der Anwendung</div>
                </div>
                <div class="profile-list-container">
                    <h4>Verfügbare Profile</h4>
                    <div id="profile-list" class="profile-list"></div>
                </div>
                <div class="create-profile-container">
                    <h4>Neues Profil erstellen</h4>
                    <div class="create-profile-form">
                        <input type="text" id="new-profile-username" placeholder="Profile Name" class="form-input">
                        <button id="create-profile-btn" class="btn btn-primary">
                            <i data-lucide="plus"></i>
                            Erstellen
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Create Flow -->
    <div id="flow-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i data-lucide="git-branch"></i>
                    Create Automation Flow
                </h3>
                <button id="flow-modal-close" class="modal-close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="flow-name">Flow Name</label>
                    <input type="text" id="flow-name" placeholder="e.g., Thank you for big gifts" class="form-input">
                </div>
                <div class="form-group">
                    <label for="flow-trigger-type">Trigger Event</label>
                    <select id="flow-trigger-type" class="form-select">
                        <option value="gift">🎁 Gift Received</option>
                        <option value="follow">⭐ New Follow</option>
                        <option value="subscribe">🌟 New Subscribe</option>
                        <option value="share">🔄 Stream Shared</option>
                        <option value="like">❤️ Likes</option>
                        <option value="chat">💬 Chat Message</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="flow-action-type">Action Type</label>
                    <select id="flow-action-type" class="form-select">
                        <option value="alert">🔔 Show Alert</option>
                        <option value="webhook">🌐 Webhook (HTTP Request)</option>
                    </select>
                </div>
                <div id="alert-settings" class="form-group">
                    <label for="flow-action-text">Alert Text (supports variables)</label>
                    <textarea id="flow-action-text" placeholder="e.g., Thank you {username} for {gift_name}!" class="form-textarea"></textarea>
                    <p class="form-help">Available variables: {username}, {gift_name}, {coins}, {message}</p>
                </div>
                <div id="webhook-settings" class="form-group" style="display: none;">
                    <label for="flow-webhook-url">Webhook URL</label>
                    <input type="text" id="flow-webhook-url" placeholder="https://webhook.site/..." class="form-input">
                    <p class="form-help">Allowed domains: webhook.site, discord.com, zapier.com, ifttt.com, make.com</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="flow-modal-save-btn" class="btn btn-primary">
                    <i data-lucide="check"></i>
                    Create Flow
                </button>
                <button id="flow-modal-cancel-btn" class="btn btn-ghost">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Audio Elements for Dashboard Playback -->
    <audio id="dashboard-tts-audio"></audio>
    <div id="dashboard-soundboard-pool"></div>

    <!-- Scripts -->
    <!-- Audio unlock must load first to handle autoplay restrictions -->
    <script src="/js/audio-unlock.js"></script>
    <!-- Initialization helper to prevent race conditions -->
    <script src="/js/init-helper.js"></script>
    <script src="/js/dashboard.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/js/dashboard-enhancements.js"></script>
    <script src="/js/vdoninja-dashboard.js"></script>
    <script src="/js/plugin-manager.js"></script>
    <script src="/js/update-checker.js"></script>
    <script src="/js/audio-settings.js"></script>

    <!-- Initialize Lucide Icons after DOM is ready -->
    <script>
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                if (typeof lucide !== 'undefined') lucide.createIcons();
            });
        } else {
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
    </script>
</body>
</html>
